<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <title>SPEC - Sistema de Monitoramento ILPI</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <meta name="description" content="Sistema de Monitoramento ILPI"/>
        <link href="css/thalamus.css" rel="stylesheet" type="text/css"/>
        <style>
            /* Estilos gerais */
            body {
                font-family: Arial, sans-serif;
                margin: 0;
                padding: 0;
            }

            /* Estilos da tabela */
            .tabela {
                width: 100%;
                border-collapse: collapse;
                margin-bottom: 1rem;
                background-color: #fff;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }

            .tabela thead th {
                background-color: #f8f9fa;
                font-weight: 600;
                text-align: left;
                padding: 1rem;
                border-bottom: 2px solid #dee2e6;
            }

            .tabela td {
                vertical-align: middle;
                padding: 0.75rem;
                border-bottom: 1px solid #dee2e6;
            }

            /* Estilos para chips e contadores */
            .chip {
                display: inline-block;
                padding: 2px 8px;
                border-radius: 12px;
                font-size: 0.75rem;
                margin-left: 8px;
                font-weight: 500;
            }

            .bg-ok {
                background-color: #4CAF50;
                color: white;
            }

            .bg-cinza {
                background-color: #f0f0f0;
                color: #333;
            }

            .bg-ausente {
                background-color: #FFA726;
                color: white;
            }

            .contador {
                min-width: 24px;
                text-align: center;
                margin: 0;
            }

            /* Estilos para elementos clicáveis */
            .clicavel {
                cursor: pointer;
                transition: background-color 0.2s;
            }

            .clicavel:hover {
                background-color: #f5f5f5;
            }

            /* Estilos para textos e fontes */
            .fonte-menor {
                font-size: 0.8rem;
                color: #666;
                display: block;
                margin-top: 2px;
            }

            /* Estilos para o menu lateral */
            aside {
                width: 250px;
                background-color: #fff;
                border-right: 1px solid #eee;
                height: 100%;
                position: fixed;
                left: 0;
                top: 60px;
                overflow-y: auto;
                transition: all 0.3s ease;
            }

            .esconde aside {
                width: 60px;
            }

            /* Estilos para paginação */
            .paginacao {
                display: flex;
                justify-content: center;
                gap: 0.5rem;
                margin-top: 1rem;
            }

            .paginacao a {
                padding: 0.5rem 1rem;
                border: 1px solid #dee2e6;
                border-radius: 4px;
                color: #4a6ee0;
                text-decoration: none;
                transition: all 0.2s;
            }

            .paginacao a.ativo {
                background-color: #4a6ee0;
                color: white;
                border-color: #4a6ee0;
            }

            .paginacao a:hover:not(.ativo) {
                background-color: #f8f9fa;
            }

            /* Estilos para pesquisa */
            .pesquisa {
                display: flex;
                align-items: center;
                background-color: #f8f9fa;
                border-radius: 4px;
                padding: 0.5rem;
            }

            .pesquisa input {
                border: none;
                background: none;
                padding: 0.5rem;
                width: 200px;
                outline: none;
            }

            /* Estilos para ícones */
            .icone-pesquisa {
                width: 24px;
                height: 24px;
                background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%234a6ee0"><path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>');
                background-repeat: no-repeat;
                background-position: center;
            }

            .icone-adicionar-header {
                display: inline-block;
                width: 32px;
                height: 32px;
                background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="%234a6ee0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>');
                background-repeat: no-repeat;
                background-position: center;
                background-size: 24px 24px;
                cursor: pointer;
                border: none;
                outline: none;
                transition: background-color 0.3s ease;
            }

            .icone-adicionar-header:hover {
                background-color: #f0f5ff;
                border-radius: 4px;
            }
            
            /* Estilos para status */
            .status-ativo {
                background-color: #4CAF50;
                color: white;
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 0.8rem;
            }
            
            .status-inativo {
                background-color: #F44336;
                color: white;
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 0.8rem;
            }
            
            /* Estilos para formulário */
            .form-group {
                margin-bottom: 1rem;
            }
            
            .form-group label {
                display: block;
                margin-bottom: 0.5rem;
                font-weight: 500;
            }
            
            .form-group input,
            .form-group select,
            .form-group textarea {
                width: 100%;
                padding: 0.5rem;
                border: 1px solid #ddd;
                border-radius: 4px;
                font-size: 1rem;
            }
            
            .grid-2 {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1rem;
            }
            
            .btn-primario {
                background-color: #4a6ee0;
                color: white;
                border: none;
                padding: 0.5rem 1rem;
                border-radius: 4px;
                cursor: pointer;
                font-size: 1rem;
            }
            
            .btn-secundario {
                background-color: #f8f9fa;
                color: #333;
                border: 1px solid #ddd;
                padding: 0.5rem 1rem;
                border-radius: 4px;
                cursor: pointer;
                font-size: 1rem;
                margin-right: 0.5rem;
            }
            
            /* Estilos para edição in-line */
            .editable {
                cursor: pointer;
                padding: 0.5rem;
                border-radius: 4px;
                transition: background-color 0.2s;
            }

            .editable:hover {
                background-color: #f5f5f5;
            }

            .editable-input {
                width: 100%;
                padding: 0.5rem;
                border: 1px solid #4a6ee0;
                border-radius: 4px;
                font-size: 1rem;
                box-sizing: border-box;
            }

            .editable-select {
                width: 100%;
                padding: 0.5rem;
                border: 1px solid #ddd;
                border-radius: 4px;
                font-size: 1rem;
                background-color: white;
            }
            
            /* Estilos para ícones de ação */
            .acoes {
                white-space: nowrap;
                text-align: center;
                min-width: 80px;
                padding: 0 10px;
            }

            .icone-salvar,
            .icone-excluir,
            .icone-adicionar {
                display: inline-block;
                margin: 0 5px;
                font-size: 18px;
                text-decoration: none;
                vertical-align: middle;
            }

            .acoes a:first-child {
                margin-left: 8px;
            }

            .acoes a:last-child {
                margin-right: 8px;
            }

            .icone-salvar:hover,
            .icone-adicionar:hover {
                color: #4a6ee0;
                transform: scale(1.2);
                transition: transform 0.2s;
            }

            .icone-excluir:hover {
                color: #F44336;
                transform: scale(1.2);
                transition: transform 0.2s;
            }
            
            /* Estilos para tags de mobilidade */
            .tag-mobilidade {
                display: inline-block;
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 0.8rem;
                margin-right: 5px;
                margin-bottom: 5px;
            }
            
            .tag-alta {
                background-color: #4CAF50;
                color: white;
            }
            
            .tag-media {
                background-color: #FFC107;
                color: black;
            }
            
            .tag-baixa {
                background-color: #F44336;
                color: white;
            }
            
            .tag-nenhuma {
                background-color: #9E9E9E;
                color: white;
            }
            
            /* Estilos para checkbox */
            .checkbox-container {
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
                margin-top: 10px;
            }
            
            .checkbox-item {
                display: flex;
                align-items: center;
                margin-bottom: 8px;
            }
            
            .checkbox-item input[type="checkbox"] {
                width: auto;
                margin-right: 8px;
            }
            
            /* Coluna de tipo mais larga */
            .tabela th:nth-child(3), 
            .tabela td:nth-child(3) {
                min-width: 150px;
                width: 15%;
            }
        </style>
    </head>
    <body>
        <header>
            <div class="linha">
                <div class="coluna">
                    <nav class="jm jm-menu nav-maior none" id="menu">
                        <div class="separador">
                            <a href="configuracoes.html">Configurações</a>
                            <a href="hospedes.html">Gestão de Hóspedes</a>
                            <a href="monitoramento.html" class="ativo">Monitoramento</a>
                            <a href="#">Sair</a>
                        </div>
                    </nav>
                    <a href="inicial.html" class="logo logo-menor">Thalamus</a>
                    <a href="#" class="icone-avancar negrito com-texto" onclick="document.getElementById('menu').classList.toggle('none');this.classList.toggle('ativo');return false">Monitoramento</a>
                </div>
                <div class="coluna direita">
                    <a href="#" class="icone-adicionar-header" title="Adicionar Classe" onclick="focarNovoClasse()"></a>
                    <a href="#" class="avatar" onclick="document.getElementById('usuario').classList.toggle('none');this.classList.toggle('ativo');return false" title="Usuário">
                        <img src="img/avatar.png"/>
                    </a>
                </div>
            </div>
        </header>

        <main id="main">  
            <aside>
                <div class="titulo margem efeito">
                    <div class="m-icone"><a href="#" class="icone-menu" title="Menu" onclick="document.getElementById('main').classList.toggle('esconde');return false"></a></div>
                </div>
                <div class="separador margem">
                    <div class="m-icone">
                        <a href="javascript:abaMenu('Monitoramento')" class="icone-compras ativo" title="Monitoramento" id="Monitoramento"></a>
                        <a href="javascript:abaMenu('Configuracoes')" class="icone-gestao" title="Configurações" id="Configuracoes"></a>
                        <a href="javascript:abaMenu('Relatorios')" class="icone-alvo" title="Relatórios" id="Relatorios"></a>
                    </div>
                </div>
                <nav id="menuMonitoramento" class="nav-maior separador">
                    <a href="cameras.html">Câmeras e Quartos</a>
                    <a href="eventosMonitorados.html">Eventos Monitorados</a>
                    <a href="classesHospedes.html" class="ativo">Classes de Hóspedes</a>
                    <a href="alertas.html">Alertas</a>
                </nav>
                <nav id="menuConfiguracoes" class="nav-maior separador none">
                    <a href="config-cameras.html">Configurações de Câmeras</a>
                    <a href="config-eventos.html">Configurações de Eventos</a>
                    <a href="config-alertas.html">Configurações de Alertas</a>
                </nav>
                <nav id="menuRelatorios" class="nav-maior separador none">
                    <a href="relatorio-eventos.html">Relatório de Eventos</a>
                    <a href="relatorio-alertas.html">Relatório de Alertas</a>
                    <a href="estatisticas.html">Estatísticas</a>
                </nav>
            </aside>
            <section>
                <div class="titulo">
                    <div class="margem container">
                        <div class="m-icone direita">
                            <div class="pesquisa">
                                <input type="text" placeholder="Pesquise aqui" id="searchInput" onkeyup="pesquisarClasses()">
                                <a href="#" class="icone-pesquisa" title="Pesquise"></a>
                            </div>
                            <a href="#" class="icone-adicionar-header" title="Adicionar Classe" onclick="focarNovoClasse()"></a>
                        </div>
                        <h2>Classes de Hóspedes</h2> 
                    </div>
                </div>
                <div class="margem container">
                    <div class="bloco margem">
                        <table class="tabela">
                            <thead>
                                <tr>
                                    <th>ID Classe</th>
                                    <th>Nome da Classe</th>
                                    <th>Tipo de Mobilidade</th>
                                    <th>Nível de Assistência</th>
                                    <th>Condições Associadas</th>
                                    <th>Status</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="tabelaClasses">
                                <!-- Dados serão inseridos via JavaScript -->
                            </tbody>
                        </table>
                        <div class="paginacao">
                            <a href="#" class="ativo">1</a>
                            <a href="#">2</a>
                            <a href="#">3</a>
                            <span>...</span>
                            <a href="#">5</a>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <script>
            // Dados das classes de hóspedes (simulando um banco de dados)
            let classesHospedes = [
                {
                    id: "CL001",
                    nome: "Cadeirante",
                    tipoMobilidade: "baixa",
                    nivelAssistencia: "medio",
                    condicoesAssociadas: ["Mobilidade reduzida", "Necessita auxílio para transferência"],
                    status: "ativo"
                },
                {
                    id: "CL002",
                    nome: "Acamado com mobilidade",
                    tipoMobilidade: "baixa",
                    nivelAssistencia: "alto",
                    condicoesAssociadas: ["Acamado", "Mobilidade limitada de membros", "Risco de úlcera de pressão"],
                    status: "ativo"
                },
                {
                    id: "CL003",
                    nome: "Deambulante com auxílio",
                    tipoMobilidade: "media",
                    nivelAssistencia: "medio",
                    condicoesAssociadas: ["Usa andador", "Risco de queda"],
                    status: "ativo"
                },
                {
                    id: "CL004",
                    nome: "Deambulante independente",
                    tipoMobilidade: "alta",
                    nivelAssistencia: "baixo",
                    condicoesAssociadas: ["Independente", "Monitoramento preventivo"],
                    status: "ativo"
                },
                {
                    id: "CL005",
                    nome: "Acamado sem mobilidade",
                    tipoMobilidade: "nenhuma",
                    nivelAssistencia: "alto",
                    condicoesAssociadas: ["Acamado", "Dependente total", "Risco alto de úlcera de pressão"],
                    status: "ativo"
                }
            ];

            // Condições de saúde disponíveis para associação
            const condicoesSaude = [
                "Mobilidade reduzida",
                "Necessita auxílio para transferência",
                "Acamado",
                "Mobilidade limitada de membros",
                "Risco de úlcera de pressão",
                "Usa andador",
                "Usa bengala",
                "Risco de queda",
                "Independente",
                "Monitoramento preventivo",
                "Dependente total",
                "Demência",
                "Alzheimer",
                "Parkinson",
                "AVC prévio",
                "Diabetes",
                "Hipertensão",
                "Problemas cardíacos",
                "Problemas respiratórios",
                "Deficiência visual",
                "Deficiência auditiva"
            ];

            // Função para controlar o menu lateral
            function abaMenu(aba) {
                // Primeiro, remova todas as classes ativas dos ícones
                document.getElementById('Monitoramento').classList.remove('ativo');
                document.getElementById('Configuracoes').classList.remove('ativo');
                document.getElementById('Relatorios').classList.remove('ativo');
              
                // Em seguida, esconda todos os menus
                document.getElementById('menuMonitoramento').classList.add('none');
                document.getElementById('menuConfiguracoes').classList.add('none');
                document.getElementById('menuRelatorios').classList.add('none');
              
                // Por fim, ative o ícone e mostre o menu correspondente
                document.getElementById(aba).classList.add('ativo');
                document.getElementById('menu' + aba).classList.remove('none');
              
                // Salvar o estado do menu no localStorage
                localStorage.setItem('menuAtivo', aba);
            }  
                  
            // Função para renderizar a tabela
            function renderizarTabela() {
                const tbody = document.getElementById('tabelaClasses');
                tbody.innerHTML = '';

                classesHospedes.forEach(classe => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td class="editable" data-field="id">${classe.id}</td>
                        <td class="editable" data-field="nome">${classe.nome}</td>
                        <td>
                            <select class="editable-select" data-field="tipoMobilidade">
                                <option value="alta" ${classe.tipoMobilidade === 'alta' ? 'selected' : ''}>Alta</option>
                                <option value="media" ${classe.tipoMobilidade === 'media' ? 'selected' : ''}>Média</option>
                                <option value="baixa" ${classe.tipoMobilidade === 'baixa' ? 'selected' : ''}>Baixa</option>
                                <option value="nenhuma" ${classe.tipoMobilidade === 'nenhuma' ? 'selected' : ''}>Nenhuma</option>
                            </select>
                        </td>
                        <td>
                            <select class="editable-select" data-field="nivelAssistencia">
                                <option value="baixo" ${classe.nivelAssistencia === 'baixo' ? 'selected' : ''}>Baixo</option>
                                <option value="medio" ${classe.nivelAssistencia === 'medio' ? 'selected' : ''}>Médio</option>
                                <option value="alto" ${classe.nivelAssistencia === 'alto' ? 'selected' : ''}>Alto</option>
                            </select>
                        </td>
                        <td>
                            <div class="condicoes-container">
                                ${classe.condicoesAssociadas.map(condicao => 
                                    `<span class="tag-mobilidade tag-media">${condicao}</span>`
                                ).join('')}
                                <a href="#" onclick="editarCondicoes('${classe.id}')">Editar</a>
                            </div>
                        </td>
                        <td>
                            <select class="editable-select" data-field="status">
                                <option value="ativo" ${classe.status === 'ativo' ? 'selected' : ''}>Ativo</option>
                                <option value="inativo" ${classe.status === 'inativo' ? 'selected' : ''}>Inativo</option>
                            </select>
                        </td>
                        <td class="acoes">
                            <a href="#" class="icone-salvar" onclick="salvarLinha('${classe.id}')">💾</a>
                            <a href="#" class="icone-excluir" onclick="excluirClasse('${classe.id}')">🗑️</a>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });

                // Adicionar linha para nova classe
                const trNovo = document.createElement('tr');
                trNovo.innerHTML = `
                    <td><input type="text" placeholder="ID da Classe" id="novoId"></td>
                    <td><input type="text" placeholder="Nome da Classe" id="novoNome"></td>
                    <td>
                        <select id="novoTipoMobilidade">
                            <option value="">Selecione</option>
                            <option value="alta">Alta</option>
                            <option value="media">Média</option>
                            <option value="baixa">Baixa</option>
                            <option value="nenhuma">Nenhuma</option>
                        </select>
                    </td>
                    <td>
                        <select id="novoNivelAssistencia">
                            <option value="">Selecione</option>
                            <option value="baixo">Baixo</option>
                            <option value="medio">Médio</option>
                            <option value="alto">Alto</option>
                        </select>
                    </td>
                    <td>
                        <button class="btn-secundario" onclick="selecionarCondicoesNovo()">Selecionar Condições</button>
                        <div id="novoCondicoesPreview"></div>
                    </td>
                    <td>
                        <select id="novoStatus">
                            <option value="ativo">Ativo</option>
                            <option value="inativo">Inativo</option>
                        </select>
                    </td>
                    <td class="acoes">
                        <a href="#" class="icone-adicionar" onclick="adicionarNovaClasse()">➕</a>
                    </td>
                `;
                tbody.appendChild(trNovo);

                // Adicionar eventos para edição in-line
                document.querySelectorAll('.editable').forEach(cell => {
                    cell.addEventListener('click', function() {
                        const field = this.dataset.field;
                        const value = this.textContent;
                        const id = this.parentElement.querySelector('[data-field="id"]').textContent;
                        
                        this.innerHTML = `<input type="text" class="editable-input" value="${value}" data-original="${value}" onblur="updateField(this, '${id}', '${field}')" onkeypress="handleKeyPress(event, this, '${id}', '${field}')">`;
                        this.querySelector('input').focus();
                    });
                });

                document.querySelectorAll('.editable-select').forEach(select => {
                    select.addEventListener('change', function() {
                        const field = this.dataset.field;
                        const id = this.closest('tr').querySelector('[data-field="id"]').textContent;
                        const classe = classesHospedes.find(c => c.id === id);
                        
                        if (classe) {
                            classe[field] = this.value;
                        }
                    });
                });
            }

            // Função para pesquisar classes
            function pesquisarClasses() {
                const searchTerm = document.getElementById('searchInput').value.toLowerCase();
                const tbody = document.getElementById('tabelaClasses');
                tbody.innerHTML = '';

                classesHospedes.filter(classe => 
                    classe.id.toLowerCase().includes(searchTerm) ||
                    classe.nome.toLowerCase().includes(searchTerm) ||
                    classe.condicoesAssociadas.some(condicao => condicao.toLowerCase().includes(searchTerm))
                ).forEach(classe => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td class="editable" data-field="id">${classe.id}</td>
                        <td class="editable" data-field="nome">${classe.nome}</td>
                        <td>
                            <select class="editable-select" data-field="tipoMobilidade">
                                <option value="alta" ${classe.tipoMobilidade === 'alta' ? 'selected' : ''}>Alta</option>
                                <option value="media" ${classe.tipoMobilidade === 'media' ? 'selected' : ''}>Média</option>
                                <option value="baixa" ${classe.tipoMobilidade === 'baixa' ? 'selected' : ''}>Baixa</option>
                                <option value="nenhuma" ${classe.tipoMobilidade === 'nenhuma' ? 'selected' : ''}>Nenhuma</option>
                            </select>
                        </td>
                        <td>
                            <select class="editable-select" data-field="nivelAssistencia">
                                <option value="baixo" ${classe.nivelAssistencia === 'baixo' ? 'selected' : ''}>Baixo</option>
                                <option value="medio" ${classe.nivelAssistencia === 'medio' ? 'selected' : ''}>Médio</option>
                                <option value="alto" ${classe.nivelAssistencia === 'alto' ? 'selected' : ''}>Alto</option>
                            </select>
                        </td>
                        <td>
                            <div class="condicoes-container">
                                ${classe.condicoesAssociadas.map(condicao => 
                                    `<span class="tag-mobilidade tag-media">${condicao}</span>`
                                ).join('')}
                                <a href="#" onclick="editarCondicoes('${classe.id}')">Editar</a>
                            </div>
                        </td>
                        <td>
                            <select class="editable-select" data-field="status">
                                <option value="ativo" ${classe.status === 'ativo' ? 'selected' : ''}>Ativo</option>
                                <option value="inativo" ${classe.status === 'inativo' ? 'selected' : ''}>Inativo</option>
                            </select>
                        </td>
                        <td class="acoes">
                            <a href="#" class="icone-salvar" onclick="salvarLinha('${classe.id}')">💾</a>
                            <a href="#" class="icone-excluir" onclick="excluirClasse('${classe.id}')">🗑️</a>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });

                // Adicionar linha para nova classe
                const trNovo = document.createElement('tr');
                trNovo.innerHTML = `
                    <td><input type="text" placeholder="ID da Classe" id="novoId"></td>
                    <td><input type="text" placeholder="Nome da Classe" id="novoNome"></td>
                    <td>
                        <select id="novoTipoMobilidade">
                            <option value="">Selecione</option>
                            <option value="alta">Alta</option>
                            <option value="media">Média</option>
                            <option value="baixa">Baixa</option>
                            <option value="nenhuma">Nenhuma</option>
                        </select>
                    </td>
                    <td>
                        <select id="novoNivelAssistencia">
                            <option value="">Selecione</option>
                            <option value="baixo">Baixo</option>
                            <option value="medio">Médio</option>
                            <option value="alto">Alto</option>
                        </select>
                    </td>
                    <td>
                       <button class="btn-secundario" onclick="selecionarCondicoesNovo()">Selecionar Condições</button>
                        <div id="novoCondicoesPreview"></div>
                    </td>
                    <td>
                        <select id="novoStatus">
                            <option value="ativo">Ativo</option>
                            <option value="inativo">Inativo</option>
                        </select>
                    </td>
                    <td class="acoes">
                        <a href="#" class="icone-adicionar" onclick="adicionarNovaClasse()">➕</a>
                    </td>
                `;
                tbody.appendChild(trNovo);

                // Adicionar eventos para edição in-line
                document.querySelectorAll('.editable').forEach(cell => {
                    cell.addEventListener('click', function() {
                        const field = this.dataset.field;
                        const value = this.textContent;
                        const id = this.parentElement.querySelector('[data-field="id"]').textContent;
                        
                        this.innerHTML = `<input type="text" class="editable-input" value="${value}" data-original="${value}" onblur="updateField(this, '${id}', '${field}')" onkeypress="handleKeyPress(event, this, '${id}', '${field}')">`;
                        this.querySelector('input').focus();
                    });
                });

                document.querySelectorAll('.editable-select').forEach(select => {
                    select.addEventListener('change', function() {
                        const field = this.dataset.field;
                        const id = this.closest('tr').querySelector('[data-field="id"]').textContent;
                        const classe = classesHospedes.find(c => c.id === id);
                        
                        if (classe) {
                            classe[field] = this.value;
                        }
                    });
                });
            }

            // Função para atualizar um campo após edição in-line
            function updateField(input, id, field) {
                const newValue = input.value;
                const originalValue = input.dataset.original;
                const cell = input.parentElement;
                
                if (newValue !== originalValue) {
                    const classe = classesHospedes.find(c => c.id === id);
                    if (classe) {
                        classe[field] = newValue;
                    }
                }
                
                cell.textContent = newValue;
            }

            // Função para lidar com tecla Enter durante edição in-line
            function handleKeyPress(event, input, id, field) {
                if (event.key === 'Enter') {
                    updateField(input, id, field);
                }
            }

            // Função para salvar uma linha após edição
            function salvarLinha(id) {
                const classe = classesHospedes.find(c => c.id === id);
                if (classe) {
                    alert(`Classe "${classe.nome}" salva com sucesso!`);
                }
            }

            // Função para excluir uma classe
            function excluirClasse(id) {
                if (confirm('Deseja realmente excluir esta classe de hóspede?')) {
                    classesHospedes = classesHospedes.filter(c => c.id !== id);
                    renderizarTabela();
                    alert('Classe excluída com sucesso!');
                }
            }

            // Variável para armazenar condições selecionadas para nova classe
            let novasCondicoesSelecionadas = [];

            // Função para selecionar condições para nova classe
            function selecionarCondicoesNovo() {
                // Criar modal para seleção de condições
                const modalHTML = `
                    <div class="modal-overlay" id="modalCondicoes" style="display: flex;">
                        <div class="modal" style="width: 80%; max-width: 600px;">
                            <div class="modal-mask">
                                <div class="jm">
                                    <div class="modal-header">
                                        <h3>Selecionar Condições de Saúde</h3>
                                    </div>
                                    <div class="checkbox-container" id="condicoesCheckboxes">
                                        ${condicoesSaude.map(condicao => `
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="cond-${condicao.replace(/\s+/g, '-').toLowerCase()}" 
                                                    value="${condicao}" 
                                                    ${novasCondicoesSelecionadas.includes(condicao) ? 'checked' : ''}>
                                                <label for="cond-${condicao.replace(/\s+/g, '-').toLowerCase()}">${condicao}</label>
                                            </div>
                                        `).join('')}
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn-secundario" onclick="fecharModalCondicoes()">Cancelar</button>
                                        <button type="button" class="btn-primario" onclick="salvarCondicoesNovo()">Salvar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Adicionar modal ao corpo do documento
                const modalContainer = document.createElement('div');
                modalContainer.innerHTML = modalHTML;
                document.body.appendChild(modalContainer);
            }

            // Função para fechar modal de condições
            function fecharModalCondicoes() {
                const modal = document.getElementById('modalCondicoes');
                if (modal) {
                    modal.parentNode.removeChild(modal);
                }
            }

            // Função para salvar condições selecionadas para nova classe
            function salvarCondicoesNovo() {
                novasCondicoesSelecionadas = [];
                const checkboxes = document.querySelectorAll('#condicoesCheckboxes input[type="checkbox"]:checked');
                
                checkboxes.forEach(checkbox => {
                    novasCondicoesSelecionadas.push(checkbox.value);
                });
                
                // Atualizar preview das condições selecionadas
                const previewElement = document.getElementById('novoCondicoesPreview');
                if (previewElement) {
                    previewElement.innerHTML = novasCondicoesSelecionadas.map(condicao => 
                        `<span class="tag-mobilidade tag-media">${condicao}</span>`
                    ).join('');
                }
                
                fecharModalCondicoes();
            }

            // Função para editar condições de uma classe existente
            function editarCondicoes(id) {
                const classe = classesHospedes.find(c => c.id === id);
                if (!classe) return;
                
                // Criar modal para seleção de condições
                const modalHTML = `
                    <div class="modal-overlay" id="modalCondicoes" style="display: flex;">
                        <div class="modal" style="width: 80%; max-width: 600px;">
                            <div class="modal-mask">
                                <div class="jm">
                                    <div class="modal-header">
                                        <h3>Editar Condições de Saúde - ${classe.nome}</h3>
                                    </div>
                                    <div class="checkbox-container" id="condicoesCheckboxes">
                                        ${condicoesSaude.map(condicao => `
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="cond-${condicao.replace(/\s+/g, '-').toLowerCase()}" 
                                                    value="${condicao}" 
                                                    ${classe.condicoesAssociadas.includes(condicao) ? 'checked' : ''}>
                                                <label for="cond-${condicao.replace(/\s+/g, '-').toLowerCase()}">${condicao}</label>
                                            </div>
                                        `).join('')}
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn-secundario" onclick="fecharModalCondicoes()">Cancelar</button>
                                        <button type="button" class="btn-primario" onclick="salvarCondicoesExistente('${id}')">Salvar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Adicionar modal ao corpo do documento
                const modalContainer = document.createElement('div');
                modalContainer.innerHTML = modalHTML;
                document.body.appendChild(modalContainer);
            }

            // Função para salvar condições de uma classe existente
            function salvarCondicoesExistente(id) {
                const classe = classesHospedes.find(c => c.id === id);
                if (!classe) return;
                
                const condicoesSelecionadas = [];
                const checkboxes = document.querySelectorAll('#condicoesCheckboxes input[type="checkbox"]:checked');
                
                checkboxes.forEach(checkbox => {
                    condicoesSelecionadas.push(checkbox.value);
                });
                
                classe.condicoesAssociadas = condicoesSelecionadas;
                
                fecharModalCondicoes();
                renderizarTabela();
            }

            // Função para adicionar nova classe
            function adicionarNovaClasse() {
                const id = document.getElementById('novoId').value;
                const nome = document.getElementById('novoNome').value;
                const tipoMobilidade = document.getElementById('novoTipoMobilidade').value;
                const nivelAssistencia = document.getElementById('novoNivelAssistencia').value;
                const status = document.getElementById('novoStatus').value;
                
                // Validar campos obrigatórios
                if (!id || !nome || !tipoMobilidade || !nivelAssistencia) {
                    alert('Por favor, preencha todos os campos obrigatórios!');
                    return;
                }
                
                // Verificar se já existe uma classe com o mesmo ID
                if (classesHospedes.some(c => c.id === id)) {
                    alert('Já existe uma classe com este ID!');
                    return;
                }
                
                // Criar nova classe
                const novaClasse = {
                    id,
                    nome,
                    tipoMobilidade,
                    nivelAssistencia,
                    condicoesAssociadas: novasCondicoesSelecionadas,
                    status
                };
                
                // Adicionar à lista de classes
                classesHospedes.push(novaClasse);
                
                // Limpar seleção de condições para próxima classe
                novasCondicoesSelecionadas = [];
                
                // Atualizar tabela
                renderizarTabela();
                
                alert(`Classe "${nome}" adicionada com sucesso!`);
            }

            // Função para focar no campo de ID da nova classe
            function focarNovoClasse() {
                const idInput = document.getElementById('novoId');
                if (idInput) {
                    idInput.focus();
                    // Rolar até o final da tabela
                    const tabela = document.querySelector('.tabela');
                    if (tabela) {
                        tabela.scrollIntoView({ behavior: 'smooth', block: 'end' });
                    }
                }
            }

            // Inicializar a página
            document.addEventListener('DOMContentLoaded', function() {
                renderizarTabela();
              
                // Recuperar o estado do menu do localStorage
                const menuAtivo = localStorage.getItem('menuAtivo') || 'Monitoramento';
              
                // Aplicar o estado do menu
                document.getElementById('Monitoramento').classList.remove('ativo');
                document.getElementById('Configuracoes').classList.remove('ativo');
                document.getElementById('Relatorios').classList.remove('ativo');

                document.getElementById('menuMonitoramento').classList.add('none');
                document.getElementById('menuConfiguracoes').classList.add('none');
                document.getElementById('menuRelatorios').classList.add('none');

                document.getElementById(menuAtivo).classList.add('ativo');
                document.getElementById('menu' + menuAtivo).classList.remove('none');
            });
        </script>
    </body>
</html>